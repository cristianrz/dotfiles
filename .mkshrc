#!/bin/ksh

# check if this is really mksh
case ${KSH_VERSION:-} in
*LEGACY\ KSH*|*MIRBSD\ KSH*) ;;
*) \return 0 ;;
esac

export EDITOR="vi"
export TERM=xterm

# source the system-wide mkshrc file
if [[ -s /etc/mkshrc ]]; then
    # shellcheck source=/dev/null
    . /etc/mkshrc
fi

# work around #813164
alias ls='ls -N'

# prepend $debian_chroot support to PS1
p=$'\001'

if [[ ${PS1:1:1} = $'\r' ]]; then
	p=${PS1:0:1}
	PS1=${PS1:2}
else
	p=$'\001'
fi

if [[ -z ${debian_chroot:-} && -r /etc/debian_chroot ]]; then
    debian_chroot=$(</etc/debian_chroot)
fi

# shellcheck disable=SC2025
PS1=$p$'\r${debian_chroot:+'$p$'\e[0;1m'$p'($debian_chroot)'$p$'\e[0m'$p'}'$PS1
unset p


set -U; [[ ${LC_ALL:-${LC_CTYPE:-${LANG:-}}} = *[Uu][Tt][Ff]?(-)8* ]] || \\builtin set +U

unset p

HISTFILE="$HOME"/.mksh_history

pgrep tmux >/dev/null || exec tmux
